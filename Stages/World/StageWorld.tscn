[gd_scene load_steps=23 format=2]

[ext_resource path="res://Stages/World/StageWorld.cs" type="Script" id=1]
[ext_resource path="res://Interface/Themes/Hospital.tres" type="Theme" id=2]
[ext_resource path="res://Levels/Common/LevelManager/LevelManager.cs" type="Script" id=3]
[ext_resource path="res://Stages/World/HUD/HUD.cs" type="Script" id=4]
[ext_resource path="res://icon.png" type="Texture" id=5]
[ext_resource path="res://Systems/SaveSystem/FileDialogFixed.cs" type="Script" id=6]
[ext_resource path="res://Systems/DialogueSystem/DialogueControl.tscn" type="PackedScene" id=7]
[ext_resource path="res://Interface/Panels/NPCInfoPanel.tscn" type="PackedScene" id=8]
[ext_resource path="res://Systems/BattleSystem/CntBattle.tscn" type="PackedScene" id=9]
[ext_resource path="res://Interface/Panels/PnlPreBattle.tscn" type="PackedScene" id=10]
[ext_resource path="res://Stages/World/Music/UnstableAlchemy_World.ogg" type="AudioStream" id=11]
[ext_resource path="res://Interface/Cursors/CursorControl.tscn" type="PackedScene" id=12]
[ext_resource path="res://Systems/SettingsManager/PnlSettings.tscn" type="PackedScene" id=13]
[ext_resource path="res://Systems/AudioManager/AudioData.tscn" type="PackedScene" id=14]
[ext_resource path="res://Stages/World/PnlBattleVictory.cs" type="Script" id=15]
[ext_resource path="res://Stages/World/Music/SadAlchemy_World.ogg" type="AudioStream" id=16]
[ext_resource path="res://Interface/PartyManagement/HBoxPortraits.cs" type="Script" id=17]
[ext_resource path="res://Interface/Cursors/Art/Hint.PNG" type="Texture" id=18]
[ext_resource path="res://Interface/PartyManagement/PnlCharacterManager.cs" type="Script" id=19]

[sub_resource type="Animation" id=1]
resource_name = "Load"
length = 0.6
loop = true
tracks/0/type = "value"
tracks/0/path = NodePath(".:modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0, 0.3, 0.6 ),
"transitions": PoolRealArray( 1, 1, 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 1 ), Color( 1, 1, 1, 0 ), Color( 1, 1, 1, 1 ) ]
}

[sub_resource type="Animation" id=2]
resource_name = "LogEntry"
length = 3.0
tracks/0/type = "value"
tracks/0/path = NodePath(".:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 1,
"values": [ true ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:modulate")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0, 0.2, 1.5, 3 ),
"transitions": PoolRealArray( 1, 1, 1, 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 0 ), Color( 1, 1, 1, 1 ), Color( 1, 1, 1, 1 ), Color( 1, 1, 1, 0 ) ]
}

[sub_resource type="Animation" id=3]
length = 0.2
tracks/0/type = "value"
tracks/0/path = NodePath(".:visible")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 1,
"values": [ false ]
}
tracks/1/type = "value"
tracks/1/path = NodePath(".:modulate")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ Color( 1, 1, 1, 0 ) ]
}

[node name="StageWorld" type="Node"]
script = ExtResource( 1 )

[node name="AudioMusic" parent="." instance=ExtResource( 14 )]
VolumeDb = -10.0
StartPlaying = true
Streams = [ ExtResource( 16 ), ExtResource( 11 ) ]
Bus = 2
SoundType = 3

[node name="LevelManager" type="Node2D" parent="."]
script = ExtResource( 3 )

[node name="HUD" type="CanvasLayer" parent="."]
pause_mode = 2
script = ExtResource( 4 )

[node name="CtrlTheme" type="Control" parent="HUD"]
margin_left = 960.0
margin_top = 540.0
margin_right = 960.0
margin_bottom = 540.0
theme = ExtResource( 2 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="PnlUIBar" type="Panel" parent="HUD/CtrlTheme"]
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
margin_left = -960.0
margin_top = 492.0
margin_right = 960.0
margin_bottom = 540.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="HBoxBtns" type="HBoxContainer" parent="HUD/CtrlTheme/PnlUIBar"]
margin_left = 1752.0
margin_top = 1.0
margin_right = 1908.0
margin_bottom = 42.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="BtnMenu" type="Button" parent="HUD/CtrlTheme/PnlUIBar/HBoxBtns"]
margin_right = 156.0
margin_bottom = 41.0
size_flags_horizontal = 3
text = "Menu"
clip_text = true
__meta__ = {
"_edit_use_anchors_": false
}

[node name="HBoxPortraits" type="Control" parent="HUD/CtrlTheme/PnlUIBar"]
script = ExtResource( 17 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="PBtnPlayer" type="Button" parent="HUD/CtrlTheme/PnlUIBar/HBoxPortraits"]
margin_left = 10.0
margin_right = 60.0
margin_bottom = 40.0
size_flags_horizontal = 3
__meta__ = {
"_edit_use_anchors_": false
}

[node name="TexRect" type="TextureRect" parent="HUD/CtrlTheme/PnlUIBar/HBoxPortraits/PBtnPlayer"]
margin_left = 9.0
margin_top = 4.0
margin_right = 41.0
margin_bottom = 36.0
texture = ExtResource( 18 )
expand = true
__meta__ = {
"_edit_use_anchors_": false
}

[node name="PBtnCompanion1" type="Button" parent="HUD/CtrlTheme/PnlUIBar/HBoxPortraits"]
margin_left = 65.0
margin_right = 115.0
margin_bottom = 40.0
size_flags_horizontal = 3

[node name="TexRect" type="TextureRect" parent="HUD/CtrlTheme/PnlUIBar/HBoxPortraits/PBtnCompanion1"]
margin_left = 9.0
margin_top = 4.0
margin_right = 41.0
margin_bottom = 36.0
texture = ExtResource( 18 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="PBtnCompanion2" type="Button" parent="HUD/CtrlTheme/PnlUIBar/HBoxPortraits"]
margin_left = 120.0
margin_right = 170.0
margin_bottom = 40.0
size_flags_horizontal = 3
__meta__ = {
"_edit_use_anchors_": false
}

[node name="TexRect" type="TextureRect" parent="HUD/CtrlTheme/PnlUIBar/HBoxPortraits/PBtnCompanion2"]
margin_left = 9.0
margin_top = 4.0
margin_right = 41.0
margin_bottom = 36.0
texture = ExtResource( 18 )

[node name="PopupMenu" type="PopupMenu" parent="HUD/CtrlTheme/PnlUIBar/HBoxPortraits"]
margin_left = 8.485
margin_right = 224.485
margin_bottom = 121.0
items = [ "Character Sheet", null, 0, false, false, 0, 0, null, "", false, "Inventory", null, 0, false, false, 1, 0, null, "", false, "Talk", null, 0, false, false, 2, 0, null, "", false ]

[node name="PauseRect" type="ColorRect" parent="HUD/CtrlTheme"]
visible = false
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -960.0
margin_top = -540.0
margin_right = 960.0
margin_bottom = 540.0
color = Color( 0, 0, 0, 0.670588 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="NPCInfoPanel" parent="HUD/CtrlTheme" instance=ExtResource( 8 )]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -245.0
margin_top = -167.0
margin_right = 245.0
margin_bottom = 167.0

[node name="PnlPreBattle" parent="HUD/CtrlTheme" instance=ExtResource( 10 )]

[node name="CntBattle" parent="HUD/CtrlTheme" instance=ExtResource( 9 )]
visible = false
margin_left = -960.0
margin_top = -540.0
margin_right = -960.0
margin_bottom = -540.0

[node name="DialogueControl" parent="HUD/CtrlTheme" instance=ExtResource( 7 )]
visible = false
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -1000.0
margin_top = 500.0
margin_right = -1000.0
margin_bottom = 500.0

[node name="PnlCharacterManager" type="Panel" parent="HUD/CtrlTheme"]
visible = false
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -593.0
margin_top = -342.5
margin_right = 593.0
margin_bottom = 342.5
script = ExtResource( 19 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="TabContainer" type="TabContainer" parent="HUD/CtrlTheme/PnlCharacterManager"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -574.5
margin_top = -315.5
margin_right = 574.5
margin_bottom = 315.5
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Character" type="Container" parent="HUD/CtrlTheme/PnlCharacterManager/TabContainer"]
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 46.0
margin_right = -4.0
margin_bottom = -4.0

[node name="Inventory" type="Container" parent="HUD/CtrlTheme/PnlCharacterManager/TabContainer"]
visible = false
anchor_right = 1.0
anchor_bottom = 1.0
margin_left = 4.0
margin_top = 46.0
margin_right = -4.0
margin_bottom = -4.0

[node name="BtnClose" type="Button" parent="HUD/CtrlTheme/PnlCharacterManager"]
anchor_left = 1.0
anchor_right = 1.0
margin_left = -42.0
margin_bottom = 37.0
text = "X"
__meta__ = {
"_edit_use_anchors_": false
}

[node name="PnlMenu" type="Panel" parent="HUD/CtrlTheme"]
visible = false
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -163.5
margin_top = -190.5
margin_right = 163.5
margin_bottom = 190.5
__meta__ = {
"_edit_use_anchors_": false
}

[node name="VBoxBtns" type="VBoxContainer" parent="HUD/CtrlTheme/PnlMenu"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -142.0
margin_top = -165.0
margin_right = 142.0
margin_bottom = 165.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="BtnResume" type="Button" parent="HUD/CtrlTheme/PnlMenu/VBoxBtns"]
margin_right = 284.0
margin_bottom = 62.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Resume"

[node name="BtnSave" type="Button" parent="HUD/CtrlTheme/PnlMenu/VBoxBtns"]
margin_top = 66.0
margin_right = 284.0
margin_bottom = 129.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Save"

[node name="BtnLoad" type="Button" parent="HUD/CtrlTheme/PnlMenu/VBoxBtns"]
margin_top = 133.0
margin_right = 284.0
margin_bottom = 196.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Load"

[node name="BtnSettings" type="Button" parent="HUD/CtrlTheme/PnlMenu/VBoxBtns"]
margin_top = 200.0
margin_right = 284.0
margin_bottom = 263.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Settings"

[node name="BtnExit" type="Button" parent="HUD/CtrlTheme/PnlMenu/VBoxBtns"]
margin_top = 267.0
margin_right = 284.0
margin_bottom = 330.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Exit"

[node name="PnlDefeat" type="Panel" parent="HUD/CtrlTheme"]
visible = false
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -374.5
margin_top = -289.0
margin_right = 374.5
margin_bottom = 289.0
__meta__ = {
"_edit_use_anchors_": false
}

[node name="LblTitle" type="Label" parent="HUD/CtrlTheme/PnlDefeat"]
margin_right = 737.0
margin_bottom = 95.0
text = "DEFEAT"
align = 1
valign = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="LblDefeatMessage" type="Label" parent="HUD/CtrlTheme/PnlDefeat"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -361.0
margin_top = -182.589
margin_right = 361.0
margin_bottom = -59.5891
text = "You have been defeated and your followers abandon you!"
align = 1
valign = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="VBoxBtns" type="VBoxContainer" parent="HUD/CtrlTheme/PnlDefeat"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -142.0
margin_top = -62.4106
margin_right = 142.0
margin_bottom = 267.589
__meta__ = {
"_edit_use_anchors_": false
}

[node name="BtnLoad" type="Button" parent="HUD/CtrlTheme/PnlDefeat/VBoxBtns"]
margin_right = 284.0
margin_bottom = 107.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Load"

[node name="BtnSettings" type="Button" parent="HUD/CtrlTheme/PnlDefeat/VBoxBtns"]
margin_top = 111.0
margin_right = 284.0
margin_bottom = 218.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Settings"

[node name="BtnExit" type="Button" parent="HUD/CtrlTheme/PnlDefeat/VBoxBtns"]
margin_top = 222.0
margin_right = 284.0
margin_bottom = 329.0
size_flags_horizontal = 3
size_flags_vertical = 3
text = "Exit"

[node name="PnlBattleVictory" type="Panel" parent="HUD/CtrlTheme"]
visible = false
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -439.0
margin_top = -255.5
margin_right = 439.0
margin_bottom = 255.5
script = ExtResource( 15 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="LblTitle" type="Label" parent="HUD/CtrlTheme/PnlBattleVictory"]
anchor_left = 0.5
anchor_right = 0.5
margin_left = -368.0
margin_right = 369.0
margin_bottom = 98.0
text = "VICTORY"
align = 1
valign = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="LblDefeatMessage" type="Label" parent="HUD/CtrlTheme/PnlBattleVictory"]
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
margin_left = -360.0
margin_top = -411.0
margin_right = 362.0
margin_bottom = -240.0
text = "You have defeated your foes in honourable combat!"
align = 1
valign = 1
autowrap = true
__meta__ = {
"_edit_use_anchors_": false
}

[node name="LblXPGoldMessage" type="Label" parent="HUD/CtrlTheme/PnlBattleVictory"]
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
margin_left = -360.5
margin_top = -258.091
margin_right = 361.5
margin_bottom = -91.0914
text = "EACH PARTY MEMBER GAINS x EXPERIENCE!

You FIND y GOLD!"
align = 1
valign = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="BtnContinue" type="Button" parent="HUD/CtrlTheme/PnlBattleVictory"]
anchor_left = 0.5
anchor_top = 1.0
anchor_right = 0.5
anchor_bottom = 1.0
margin_left = -87.0
margin_top = -75.6813
margin_right = 87.0
margin_bottom = -38.6813
text = "Proceed"

[node name="CanvasLayer" type="CanvasLayer" parent="HUD/CtrlTheme"]
layer = 3

[node name="PnlSettings" parent="HUD/CtrlTheme/CanvasLayer" instance=ExtResource( 13 )]
visible = false

[node name="FileDialog" type="FileDialog" parent="HUD/CtrlTheme"]
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -572.003
margin_top = -346.0
margin_right = 572.003
margin_bottom = 346.0
access = 1
filters = PoolStringArray( "*.ksav; KSAV Files" )
show_hidden_files = true
current_dir = "user://Saves"
current_file = "AUTOSAVE1.ksav"
current_path = "user://Saves/AUTOSAVE1.ksav"
script = ExtResource( 6 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="ProgressAnim" type="TextureRect" parent="HUD/CtrlTheme"]
visible = false
margin_left = 758.933
margin_top = 384.096
margin_right = 822.933
margin_bottom = 448.099
texture = ExtResource( 5 )
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Anim" type="AnimationPlayer" parent="HUD/CtrlTheme/ProgressAnim"]
anims/Load = SubResource( 1 )

[node name="LblProgress" type="Label" parent="HUD/CtrlTheme/ProgressAnim"]
margin_left = -21.3816
margin_top = 67.7083
margin_right = 99.6184
margin_bottom = 102.708
text = "Progress..."
align = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="LblLog" type="Label" parent="HUD/CtrlTheme"]
modulate = Color( 1, 1, 1, 0 )
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
margin_left = -733.0
margin_top = -463.008
margin_right = 733.0
margin_bottom = -428.008
rect_pivot_offset = Vector2( 733, 0 )
text = "Save Complete"
align = 1
valign = 1
__meta__ = {
"_edit_use_anchors_": false
}

[node name="Anim" type="AnimationPlayer" parent="HUD/CtrlTheme/LblLog"]
autoplay = "default"
anims/LogEntry = SubResource( 2 )
anims/default = SubResource( 3 )

[node name="CursorControl" parent="HUD" instance=ExtResource( 12 )]

[connection signal="pressed" from="HUD/CtrlTheme/PnlUIBar/HBoxBtns/BtnMenu" to="HUD" method="OnBtnMenuPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlUIBar/HBoxPortraits/PBtnPlayer" to="." method="OnPortraitBtnPressed" binds= [ 0 ]]
[connection signal="pressed" from="HUD/CtrlTheme/PnlUIBar/HBoxPortraits/PBtnCompanion1" to="." method="OnPortraitBtnPressed" binds= [ 1 ]]
[connection signal="pressed" from="HUD/CtrlTheme/PnlUIBar/HBoxPortraits/PBtnCompanion2" to="." method="OnPortraitBtnPressed" binds= [ 2 ]]
[connection signal="id_pressed" from="HUD/CtrlTheme/PnlUIBar/HBoxPortraits/PopupMenu" to="HUD/CtrlTheme/PnlUIBar/HBoxPortraits" method="OnPopupMenuIDPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlMenu/VBoxBtns/BtnResume" to="HUD" method="OnBtnResumePressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlMenu/VBoxBtns/BtnSave" to="HUD" method="OnBtnSavePressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlMenu/VBoxBtns/BtnLoad" to="HUD" method="OnBtnLoadPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlMenu/VBoxBtns/BtnSettings" to="." method="OnBtnSettingsPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlMenu/VBoxBtns/BtnExit" to="." method="OnBtnExitPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlDefeat/VBoxBtns/BtnLoad" to="HUD" method="OnBtnLoadPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlDefeat/VBoxBtns/BtnSettings" to="." method="OnBtnSettingsPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlDefeat/VBoxBtns/BtnExit" to="." method="OnBtnExitPressed"]
[connection signal="pressed" from="HUD/CtrlTheme/PnlBattleVictory/BtnContinue" to="HUD/CtrlTheme/PnlBattleVictory" method="OnBtnContinuePressed"]
[connection signal="file_selected" from="HUD/CtrlTheme/FileDialog" to="." method="OnFileDialogConfirmed"]
